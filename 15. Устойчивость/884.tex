% Page setup
\documentclass[a5paper,10pt]{article}

% https://github.com/InDevRus/filippov-solutions
\input{../preambles/general}

\usepackage{pgfplots}
\pgfplotsset{compat=newest}
\pgfplotsset{
    every axis/.append style = {
        xlabel={$x$},
        ylabel={$y$}, 
        axis lines = middle,
        unit vector ratio = 1 1,
        font=\small
    },
    every axis plot/.append style = {smooth, samples = 100}
}

\begin{document}

$\dfrac {dy} {dx} = \dfrac {\dot{y}} {\dot{x}} = -\dfrac {y} {x}$.
$x y'_{x}\br{x} + y = 0$. 
$xy = C$. $y = \dfrac {C} {x}$ и траектории системы представляют собой гиперболы, обе асимптоты которых суть оси фазовой плоскости.

На рисунке показаны траектории вместе с направляющими векторами, посчитанными в некоторых точках вдоль траекторий. Характер направлений указывает на то, что решения удаляются от начала координат, то есть от нулевого решения $\Phi\br{t} = \begin{pmatrix} 0 \\ 0 \end{pmatrix}$, так что решение неустойчиво, а особая точка $\left\{ \begin{matrix} x = 0 \\ y = 0 \end{matrix} \right.$ относится к типу "седло".

\begin{figure}[h]
    \begin{center}
    \begin{tikzpicture}
        \pgfplotsset{
        VectorGraph/.style = {
            -stealth,
            quiver = {
                u = -x / (x^2 + y^2) ^ 0.5, 
                v = y / (x^2 + y^2) ^ 0.5, 
                scale arrows = 0.2}
            },
        every axis plot/.append style = {thin, gray}
        }
        \begin{axis}[
            thick,
            width = \textwidth,
            height = 10cm,
            ymin = -3.4,
            ymax = 3.4,
            xmin = -3.2,
            xmax = 3.2, 
            xtick = {-3, ..., 3},
            ytick = {-5, ..., 5},
            minor tick num = 3,
            declare function = {
                f(\C, \x) = \C / x;
            }]
            
            \addplot[domain=-4:-0.05] {f(0.5, x)};
            
            \addplot[domain=0.05:4] {f(0.5, x)};
            
            \addplot[domain=-4:-0.05] {f(-0.5, x)};
            \addplot[domain=0.05:4] {f(-0.5, x)};
            \addplot[domain=-4:-0.05] {f(1, x)};
            \addplot[domain=0.05:4] {f(1, x)};
            \addplot[domain=-4:-0.05] {f(-1, x)};
            \addplot[domain=0.05:4] {f(-1, x)};
            \addplot[domain=-4:-0.05] {f(2, x)};
            \addplot[domain=0.05:4] {f(2, x)};
            \addplot[domain=-4:-0.05] {f(-2, x)};
            \addplot[domain=0.05:4] {f(-2, x)};
            
            \addplot[VectorGraph, samples = 6, domain = -3 : -0.2] {f(0.5, x)};
            \addplot[VectorGraph, samples = 6, domain = 0.2 : 3] {f(0.5, x)};
            \addplot[VectorGraph, samples = 6, domain = -3 : -0.2] {f(-0.5, x)};
            \addplot[VectorGraph, samples = 6, domain = 0.2 : 3] {f(-0.5, x)};
            \addplot[VectorGraph, samples = 6, domain = -3 : -0.2] {f(1, x)};
            \addplot[VectorGraph, samples = 6, domain = 0.2 : 3] {f(1, x)};
            \addplot[VectorGraph, samples = 6, domain = -3 : -0.2] {f(-1, x)};
            \addplot[VectorGraph, samples = 6, domain = 0.2 : 3] {f(-1, x)};
            \addplot[VectorGraph, samples = 6, domain = -3 : -0.2] {f(2, x)};
            \addplot[VectorGraph, samples = 6, domain = 0.2 : 3] {f(2, x)};
            \addplot[VectorGraph, samples = 6, domain = -3 : -0.2] {f(-2, x)};
            \addplot[VectorGraph, samples = 6, domain = 0.2 : 3] {f(-2, x)};
        \end{axis}
    \end{tikzpicture}
    \end{center}
\end{figure}

Докажем по определению неустойчивость. Общее решение равно $X\br{t} = \begin{pmatrix} A e^{-t} \\ B e^{t} \end{pmatrix}$. Для $t \ge t_{0} = 0$
\begin{align*}
\br{X\br{t} - \Phi\br{t}}^2 = A^2 e^{-2t} + B^2 e^{2t} &&
\br{X\br{t_{0}} - \Phi\br{t_{0}}}^2 = A^2 + B^2
\end{align*}

Для $\epsilon = 1$ и любого $\delta > 0$ потребуем, чтобы $A$ и $B$ были таковы, что $0 < A^2 + B^2 < \delta^2$. С другой стороны, при
$t \ge \max\br{\ln \dfrac {1} {\vbr{B}}; 0}$ имеем 
$A^2 e^{-2t} + B^2 e^{2t} \ge B^2 e^{2t} \ge 1 = \epsilon^2$, поэтому решение неустойчиво.

\end{document}
