% Page setup
\documentclass[a5paper,10pt]{article}

% https://github.com/InDevRus/filippov-solutions
\input{../preambles/general}

\usepackage{pgfplots}
\pgfplotsset{compat=newest}
\pgfplotsset{
    every axis/.append style = {
        xlabel={$x$},
        ylabel={$y$}, 
        axis lines = middle,
        unit vector ratio = 1 1,
        font=\small
    },
    every axis plot/.append style = {smooth, samples = 100}
}

\begin{document}

Искать общее решение данной системы уравнений бессмысленно с точки зрения исследования на устойчивость, так как система сводится к автономному уравнению $\ddot{x}\br{t} - \sin\br{x\br{t}} = 0$ и в результате его решения возникает интеграл
$$\bigintssss{\frac {dt} {\sqrt{A - \cos\br{t}}}},$$
который нельзя для всякого $A$ выразить в элементарных функциях.

Найдём траектории системы. $\dfrac {dy} {dx} = \dfrac {\dot{y}} {\dot{x}} = \dfrac {-\sin{x}} {y}$. $2y \dfrac {dy} {dx} = -2\sin{x}$. $y^{2} = C + 2\cos{x}$. $y^2 = 2\br{\cos x + C - 1}$. При $C < 0$ траектории не определены; при $C \ge 2$ представляют собой неограниченные кривые, и одна из таковых показана на рисунке пунктирной линией. Оба случая не представляют интереса.

Итак, с этого момента при данных обозначениях будем рассматривать траектории $y = \pm \sqrt{2\br{\cos{x} + C - 1}}$ при $0 < C < 2$. Они суть замкнутые кривые. Направления траекторий показаны на рисунке. По ним видно, нулевое решение $\Phi\br{t} = \begin{pmatrix} 0 \\ 0 \end{pmatrix}$ задаёт особую точку $\left\{ \begin{matrix} x = 0 \\ y = 0 \end{matrix} \right.$ фазовой плоскости, являющуюся "центром".

\begin{figure}[h] 
    \begin{tikzpicture}
        \pgfplotsset{
        VectorGraph/.style = {
                blue,
                -stealth,
                quiver = {
                    u = y / (x^2 + y^2) ^ 0.5, 
                    v = -sin(deg(x)) / (x^2 + y^2) ^ 0.5, 
                    scale arrows = 0.3}}
        }
        \begin{axis}[
            width = \textwidth,
            ymin = -2.25,
            ymax = 2.4,
            xmin = -3.1,
            xmax = 3.2, 
            xtick = {-3, ..., 3},
            ytick = {-5, ..., 5},
            minor tick num = 3,
            declare function = {
                f(\C, \x) = sqrt(2 * (cos(deg(x)) + \C - 1));
            }]
            
            \addplot[densely dashed, domain=-4:4, samples = 1000] {f(2.2, x)};
            \addplot[densely dashed, domain=-4:4, samples = 1000] {-f(2.2, x)};
            
            \addplot[domain=-2 * pi / 3:2 * pi / 3, samples = 1000] {f(1.5, x)};
            \addplot[domain=-2 * pi / 3:2 * pi / 3, samples = 1000] {-f(1.5, x)};
            \addplot[VectorGraph, domain=-2 * pi / 3:2 * pi / 3, samples = 13] {f(1.5, x)};
            \addplot[VectorGraph, domain=-2 * pi / 3 + 0.1:2 * pi / 3 - 0.1, samples = 11] {-f(1.5, x)};
            
            \addplot[domain=-pi/2:pi/2, samples = 1000] {f(1, x)};
            \addplot[domain=-pi/2:pi/2, samples = 1000] {-f(1, x)};
            \addplot[VectorGraph, samples = 10, domain = -pi/2:pi/2] {f(1, x)};
            \addplot[VectorGraph, samples = 8, domain = -pi/2+0.1:pi/2-0.1] {-f(1, x)};
            
            \addplot[domain=-pi/3:pi/3] {f(0.5, x)};
            \addplot[domain=-pi/3:pi/3] {-f(0.5, x)};
            \addplot[domain=pi/3:-pi/3] {f(0.5, x)};
            \addplot[domain=pi/3:-pi/3] {-f(0.5, x)};
            \addplot[VectorGraph, samples = 6, domain = -pi/3:pi/3-0.1] {f(0.5, x)};
            \addplot[VectorGraph, samples = 4, domain = -pi/3+0.01:pi/3-0.01] {-f(0.5, x)};
        \end{axis}
    \end{tikzpicture}
    \centering
\end{figure}
    
Покажем, что нулевое решение устойчиво, используя следующий вспомогательный факт.

\begin{framed}
Для $x \in \left(0; 2\right]$ выполняется неравенство $\arccos\br{1 - x} < 3\sqrt{x}.$
\begin{proof}
    Функция $f\br{x} = 3\sqrt{x} - \arccos\br{1 - x}$ определена    на $x \in \rbr{0; 2}$ и имеет производную $f'\br{x} = \dfrac {3} {2\sqrt{x}} - \dfrac {1} {\sqrt{1 - \br{1 - x}^2}}$. Приравняв её к нулю, находим единственную стационарную точку $x_{0} = \dfrac {14} {9}$. Поскольку до неё производная положительная, а после неё -- отрицательная, это -- точка максимума. Следовательно, минимальное значение достигается в одном из концов отрезка. При этом $f\br{0} = 0$ и $f\br{2} = 3\sqrt{2} - \pi > 0$. Следовательно, $f\br{x} \ge \displaystyle{\min_{x \in \left[0;2\right]}} {f\br{x}} = f\br{0} = 0$, а равенство достигается только при $x = 0$. Неравенство доказано.
\end{proof}
\end{framed}

На всякой кривой $y^2 = 2\br{\cos x + C - 1}$ точка $\left\{ \begin{matrix} x = x\br{t} \\ y = y\br{t} \end{matrix} \right.$ удалена от начала координат на расстояние $\rho\br{t} = \rho\br{x\br{t}} = \sqrt{x^2 + y^2} = \sqrt{x^2 + 2\br{\cos{x} + C - 1}}$. $\dfrac {d} {dx} \rho = 0$ только при $x = 0$, при $x > 0$ производная положительна, а сама функция $\rho\br{x}$ чётная. Следовательно, максимальное значение будет достигаться в границах $x = \pm \arccos\br{1 - C}$ области определения функций $y = \pm \sqrt{2\br{\cos{x} + C - 1}}$; минимальное достигается при $x = 0$:
\begin{align*}\rho_{\max} = \rho_{\max}\br{C} = \rho\br{\arccos\br{1 - C}}= \arccos\br{1 - C}; && \rho_{\min} = \rho_{\min}\br{C} = \rho\br{0} = \sqrt{2C}.
\end{align*}

Зафиксируем $\epsilon > 0$. Чтобы начальная точка не попала на неограниченную кривую, необходимо потребовать, чтобы выполнялось $C < 2$. Поскольку $\rho_{\max}\br{C} \le \pi$, положим $\delta = \min\br{\dfrac {\sqrt{2}} {3} \epsilon; \dfrac {\pi} {2}}$. Имеем для всех $t \ge t_{0} = 0$
\begin{align*}
    \vbr{X\br{t} - \Phi\br{t}} = \sqrt{x^2\br{t} + y^2\br{t}}
    && \vbr{X\br{t_0} - \Phi\br{t_0}} = \sqrt{x^2\br{0} + y^2\br{0}}.
\end{align*}

Пусть $\sqrt{x^2\br{0} + y^2\br{0}} < \delta$. Тогда $\delta > \sqrt{x^2\br{0} + y^2\br{0}} \ge \rho_{\min}\br{C} = \sqrt{2C}$ и $C < \dfrac {\delta^2} {2}$.

Наконец, принимая во внимание обозначенный вспомогательный факт и то, что функция $g\br{x} = \arccos\br{1 - x}$ строго возрастает, имеем для всех $t \ge t_{0}$
$$\sqrt{x^2\br{t} + y^2\br{t}} 
\le \rho_{\max}\br{C} 
= \arccos\br{1 - C}
< \arccos\br{1 - \frac {\delta^2} {2}}
< 3 \sqrt{\frac{\delta^2} {2}}
= \frac {3} {\sqrt{2}}\delta
\le \epsilon.$$

Таким образом, по определению нулевое решение устойчиво, хотя и не асимптотически, так как кривые замкнуты и точки на них стремиться к центру координат фазовой плоскости не могут.

\end{document}
