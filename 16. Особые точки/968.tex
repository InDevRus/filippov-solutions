\documentclass[a5paper,10pt]{article}

% https://github.com/InDevRus/filippov-solutions
\input{../preambles/general}
\input{../preambles/plotting}

\begin{document}

$y'\br{x} = \dfrac {-2x + 4y} {x + y}$. $A = \begin{pmatrix} 1 & 1 \\ -2 & 4 \end{pmatrix}$.
$\det\br{\lambda E - A} = \br{\lambda - 1}\br{\lambda - 4} + 2 = \lambda^2  - 5\lambda + 6$.
$\lambda_{1} = 2$, $\lambda_{2} = 3$. Особая точка является <<узлом>>.

$A - \lambda_{1}E = 
\begin{pmatrix} -1 & 1 \\ -2 & 2 \end{pmatrix}
\sim \begin{pmatrix} -1 & 1 \end{pmatrix}$, $v_{1} = \begin{pmatrix} 1 \\ 1 \end{pmatrix}$.
$A - \lambda_{2}E = 
\begin{pmatrix} -2 & 1 \\ -2 & 1 \end{pmatrix}
\sim \begin{pmatrix} -2 & 1 \end{pmatrix}$, $v_{2} = \begin{pmatrix} 1 \\ 2 \end{pmatrix}$.
$\lambda_{1}$ по модулю меньше, так что прямая $y_{1} = x$ будет являться касательной для всех траекторий (частных решений) в начале координат, кроме $y_{2} = 2x$.

Решения можно построить как при помощи изоклин, так и путём построения графика параметрических функций: 
$\tsys{& x = \pm f\br{p} \\& y = \pm p f\br{p} }$, где $f\br{p} = C \dfrac {\br{p - 1}^2} {\br{p - 2}^3}$.
На левом рисунке указаны изоклины, на правом -- истиные траектории.

\begin{figure}[!ht]
    \centering
    \begin{subfigure}[t]{0.495\textwidth}
        \centering
        \begin{tikzpicture}
            \pgfplotsset{
                VectorGraph/.style = {
                    samples = 15,
                    domain = -1:1,
                    quiver = {scale arrows = 0.05},
                },
                VectorGraph_1/.style = {
                    VectorGraph,
                    quiver = {
                        u = {dot_x(x, y) / (dot_x(x, y) ^ 2 + dot_y(x, y) ^ 2) ^ 0.5},
                        v = {dot_y(x, y) / (dot_x(x, y) ^ 2 + dot_y(x, y) ^ 2) ^ 0.5}
                    },
                },
                VectorGraph_2/.style = {
                    VectorGraph,
                    quiver = {
                        u = {-dot_x(x, y) / (dot_x(x, y) ^ 2 + dot_y(x, y) ^ 2) ^ 0.5},
                        v = {-dot_y(x, y) / (dot_x(x, y) ^ 2 + dot_y(x, y) ^ 2) ^ 0.5}
                    }
                },
            }
            \begin{axis}[
                height = 9.5cm,
                width = \linewidth,
                ymin = -2.4,
                ymax = 2.4,
                xmin = -1.4,
                xmax = 1.4, 
                xtick = {-3, -2, ..., 3},
                ytick = {-5, -4, ..., 5},
                minor tick num = 1,
                declare function = {
                    f(\C, \x) = \C * ((x - 1) ^ 2) / ((x - 2) ^ 3);
                    dot_x(\x, \y) = (x + y) / ((x ^ 2 + y ^ 2) ^ (1 / 2));
                    dot_y(\x, \y) = (-2 * x + 4 * y) / ((x ^ 2 + y ^ 2) ^ (1 / 2));
                }],
                
                \foreach \s in {-1, 1} {
                    \foreach \k in {1 / 8, 1 / 3, 1 / 2, 2 / 3, 3, 3 / 2, 5} {
                        \addplot[dotted] {\s * \k * x};
                        \addplot[VectorGraph_1] {\s * \k * x};
                        \addplot[VectorGraph_2] {\s * \k * x};
                    }
                }
                
                \foreach \k in {-1, -2} {
                    \addplot[dotted] {\k * x};
                    \addplot[VectorGraph_1] {\k * x};
                    \addplot[VectorGraph_2] {\k * x};
                }
                
                \addplot [thick] {x};
                \addplot [solid] {2 * x};
            \end{axis}
        \end{tikzpicture}
    \end{subfigure}
    \begin{subfigure}[t]{0.495\textwidth}
        \centering
        \begin{tikzpicture}
            \pgfplotsset{
                GeneralGraph_1/.style = {
                    domain = -800 : 1,
                    samples = 2000
                },
                GeneralGraph_2/.style = {
                    domain = 1 : 1.5,
                    samples = 100
                },
                GeneralGraph_3/.style = {
                    domain = 3 : 1000,
                    samples = 1000
                }
            }
            \begin{axis}[
                height = 9.5cm,
                width = \textwidth,
                ymin = -2.4,
                ymax = 2.4,
                xmin = -1.4,
                xmax = 1.4, 
                xtick = {-3, -2, ..., 3},
                ytick = {-5, -4, ..., 5},
                minor tick num = 1,
                declare function = {
                    f(\C, \x) = \C * ((x - 1) ^ 2) / ((x - 2) ^ 3);
                }],
                
                \addplot [thick] {x};
                \addplot [thin] {2 * x};
                
                \addplot [GeneralGraph_1, blue] ({f(1, x)}, {x * f(1, x)});
                \addplot [GeneralGraph_1, blue] ({-f(1, x)}, {-x * f(1, x)});
                \addplot [GeneralGraph_2, blue] ({f(1, x)}, {x * f(1, x)});
                \addplot [GeneralGraph_2, blue] ({-f(1, x)}, {-x * f(1, x)});
                \addplot [GeneralGraph_3, blue] ({f(1, x)}, {x * f(1, x)});
                \addplot [GeneralGraph_3, blue] ({-f(1, x)}, {-x * f(1, x)});
                
                \addplot [GeneralGraph_1, red] ({f(2, x)}, {x * f(2, x)});
                \addplot [GeneralGraph_1, red] ({-f(2, x)}, {-x * f(2, x)});
                \addplot [GeneralGraph_2, red] ({f(2, x)}, {x * f(2, x)});
                \addplot [GeneralGraph_2, red] ({-f(2, x)}, {-x * f(2, x)});
                \addplot [GeneralGraph_3, red] ({f(2, x)}, {x * f(2, x)});
                \addplot [GeneralGraph_3, red] ({-f(2, x)}, {-x * f(2, x)});
                
                \addplot [GeneralGraph_1, green] ({f(0.5, x)}, {x * f(0.5, x)});
                \addplot [GeneralGraph_1, green] ({-f(0.5, x)}, {-x * f(0.5, x)});
                \addplot [GeneralGraph_2, green] ({f(0.5, x)}, {x * f(0.5, x)});
                \addplot [GeneralGraph_2, green, domain = 1:1.7] ({-f(0.5, x)}, {-x * f(0.5, x)});
                \addplot [GeneralGraph_3, green] ({f(0.5, x)}, {x * f(0.5, x)});
                \addplot [GeneralGraph_3, green] ({-f(0.5, x)}, {-x * f(0.5, x)});
                
                \addplot [GeneralGraph_1, domain = -100 : 1, gray] ({f(10, x)}, {x * f(10, x)});
                \addplot [GeneralGraph_1, domain = -100 : 1, gray] ({-f(10, x)}, {-x * f(10, x)});
                \addplot [GeneralGraph_2, gray] ({f(10, x)}, {x * f(10, x)});
                \addplot [GeneralGraph_2, gray] ({-f(10, x)}, {-x * f(10, x)});
                \addplot [GeneralGraph_3, gray] ({f(10, x)}, {x * f(10, x)});
                \addplot [GeneralGraph_3, gray] ({-f(10, x)}, {-x * f(10, x)});
            \end{axis}
        \end{tikzpicture}
    \end{subfigure}
\end{figure}

\end{document}
