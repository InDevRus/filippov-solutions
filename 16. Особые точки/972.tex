\documentclass[a5paper,10pt]{article}

% https://github.com/InDevRus/filippov-solutions
\input{../preambles/general}

\usepackage{pgfplots}
\pgfplotsset{compat=newest}
\pgfplotsset{
    every axis/.append style = {
        xlabel={$x$},
        ylabel={$y$}, 
        axis lines = middle,
        unit vector ratio = 1 1,
        font=\small,
    },
    every axis plot/.append style = {smooth, samples = 100}
}

\begin{document}

$\tsys{& \dot{x} = 2x - y \\& \dot{y} = x}$.
$A = \begin{pmatrix} 2 & -1 \\ 1 & 0 \end{pmatrix}$.
$\det\br{\lambda E - A} = \lambda \br{\lambda - 2} + 1$.
$\lambda_{1} = \lambda_{2} = 1$. Особая точка является <<вырожденным узлом>>, причём неустойчивым, так как $\lambda_{1} = \lambda_{2} > 0$.

$A - \lambda_{1}E = 
\begin{pmatrix} 1 & -1 \\ 1 & -1 \end{pmatrix}
\sim \begin{pmatrix} 1 & -1 \end{pmatrix}$, $v_{1} = \begin{pmatrix} 1 \\ 1 \end{pmatrix}$.
Единственная сепаратриса $y_{1} = x$ будет являться касательной для всех траекторий в начале координат.

Решения можно построить как при помощи изоклин, так и путём построения графика параметрических функций: 
$\tsys{& x = e^{t} \br{t + 1} + C t e^{t} \\& y = t e^{t} + C e^{t} \br{t - 1} }$.
На левом рисунке указаны изоклины, на правом -- траектории.

\begin{figure}[!ht]
    \centering
    \begin{subfigure}[t]{0.495\textwidth}
        \centering
        \begin{tikzpicture}
            \pgfplotsset{
                VectorGraph/.style = {
                    samples = 17,
                    domain = -1 : 1,
                    restrict y to domain = -2 : 2,
                    skip coords between index = {8}{9},
                    quiver = {
                        scale arrows = 0.05,
                        every arrow/.append style = {
                            thin,
                            line width = 0.1pt
                        }
                    },
                },
                VectorGraph_1/.style = {
                    VectorGraph,
                    -stealth,
                    quiver = {
                        u = {dot_x(x, y) / (dot_x(x, y) ^ 2 + dot_y(x, y) ^ 2) ^ 0.5},
                        v = {dot_y(x, y) / (dot_x(x, y) ^ 2 + dot_y(x, y) ^ 2) ^ 0.5}
                    },
                },
                VectorGraph_2/.style = {
                    VectorGraph,
                    quiver = {
                        u = {-dot_x(x, y) / (dot_x(x, y) ^ 2 + dot_y(x, y) ^ 2) ^ 0.5},
                        v = {-dot_y(x, y) / (dot_x(x, y) ^ 2 + dot_y(x, y) ^ 2) ^ 0.5}
                    }
                },
            }
            \begin{axis}[
                height = 9.5cm,
                width = \linewidth,
                ymin = -2.4,
                ymax = 2.4,
                xmin = -1.4,
                xmax = 1.4, 
                xtick = {-3, -2, ..., 3},
                ytick = {-5, -4, ..., 5},
                minor tick num = 1,
                declare function = {
                    f(\C, \x) = \C * ((x - 1) ^ 2) / ((x - 2) ^ 3);
                    dot_x(\x, \y) = 2 * x - y;
                    dot_y(\x, \y) = x;
                }],
                
                \foreach \s in {-1, 1} {
                    \foreach \k in {1 / 8, 1 / 3, 1 / 2, 2 / 3, 2, 3, 3 / 2, 5, 10} {
                        \addplot[dotted] {\s * \k * x};
                        \addplot[VectorGraph_1] {\s * \k * x};
                        \addplot[VectorGraph_2] {\s * \k * x};
                    }
                }
                
                \addplot[VectorGraph_1, domain = -2 : 2] ({0}, {x});
                \addplot[VectorGraph_2, domain = -2 : 2] ({0}, {x});
                
                \foreach \k in {-1} {
                    \addplot[dotted] {\k * x};
                    \addplot[VectorGraph_1] {\k * x};
                    \addplot[VectorGraph_2] {\k * x};
                }
                
                \addplot [thick] {x};
            \end{axis}
        \end{tikzpicture}
    \end{subfigure}
    \begin{subfigure}[t]{0.495\textwidth}
        \centering
        \begin{tikzpicture}
            \pgfplotsset{
                GeneralGraph/.style = {
                    domain = -10 : 3,
                    samples = 250
                },
                VectorGraph/.style = {
                    samples = 10,
                    domain = -2 : 1.5,
                    quiver = {
                        scale arrows = 0.05,
                        every arrow/.append style = {
                            thin,
                            line width = 0.1pt
                        }
                    },
                },
                VectorGraph_1/.style = {
                    VectorGraph,
                    -stealth,
                    quiver = {
                        u = {dot_x(x, y) / (dot_x(x, y) ^ 2 + dot_y(x, y) ^ 2) ^ 0.5},
                        v = {dot_y(x, y) / (dot_x(x, y) ^ 2 + dot_y(x, y) ^ 2) ^ 0.5}
                    },
                },
                VectorGraph_2/.style = {
                    VectorGraph_1,
                    samples = 5,
                    domain = -1 : 1,
                },
            }
            \begin{axis}[
                height = 9.5cm,
                width = \textwidth,
                ymin = -2.4,
                ymax = 2.4,
                xmin = -1.4,
                xmax = 1.4, 
                xtick = {-3, -2, ..., 3},
                ytick = {-5, -4, ..., 5},
                minor tick num = 1,
                declare function = {
                    f(\C, \x) = exp(x) * (x + 1) + \C * x * exp(x);
                    g(\C, \x) = x * exp(x) + \C * exp(x) * (x - 1);
                    dot_x(\x, \y) = 2 * x - y;
                    dot_y(\x, \y) = x;
                }],
                
                \addplot [thick] {x};
                \addplot [VectorGraph_1] {x};
                
                \foreach \s in {-1, 1} {
                    \addplot [GeneralGraph, blue] ({\s * f(1, x)}, {\s * g(1, x)});
                    \addplot [VectorGraph_1, blue] ({\s * f(1, x)}, {\s * g(1, x)});
                }
                
                \foreach \s in {-1, 1} {
                    \addplot [GeneralGraph, brown] ({\s * f(-2, x)}, {\s * g(-2, x)});
                    \addplot [VectorGraph_1, brown] ({\s * f(-2, x)}, {\s * g(-2, x)});
                }
                
                \foreach \s in {-1, 1} {
                    \addplot [GeneralGraph, green] ({\s * f(1.5, x)}, {\s * g(1.5, x)});
                    \addplot [VectorGraph_1, green] ({\s * f(1.5, x)}, {\s * g(1.5, x)});
                }
                
                \foreach \s in {-1, 1} {
                    \addplot [GeneralGraph, red] ({\s * f(2, x)}, {\s * g(2, x)});
                    \addplot [VectorGraph_1, red] ({\s * f(2, x)}, {\s * g(2, x)});
                }
                
                \foreach \s in {-1, 1} {
                    \addplot [GeneralGraph, gray] ({\s * f(0.25, x)}, {\s * g(0.25, x)});
                    \addplot [VectorGraph_2, gray] ({\s * f(0.25, x)}, {\s * g(0.25, x)});
                }
                
                \foreach \s in {-1, 1} {
                    \addplot [GeneralGraph, magenta] ({\s * f(-0.5, x)}, {\s * g(-0.5, x)});
                    \addplot [VectorGraph_2, magenta] ({\s * f(-0.5, x)}, {\s * g(-0.5, x)});
                }
            \end{axis}
        \end{tikzpicture}
    \end{subfigure}
\end{figure}

\end{document}
