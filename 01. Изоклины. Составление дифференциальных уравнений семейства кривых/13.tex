\documentclass[a5paper,10pt]{article}

% https://github.com/InDevRus/filippov-solutions

\input{../preambles/general}
\input{../preambles/plotting}

\begin{document}

$f\br{x; y} = \dfrac {1 - x^2} {y^2}$. Уравнение изоклины: $\dfrac {1 - x^2} {y^2} = k$. $x^2 = 1 - ky^2$, $x = \pm \sqrt{1 - ky^2}$. Таким образом, изоклинами будут гиперболы при $k < 0$, эллипсы при $k > 0$ и две вертикальные прямые $x = \pm 1$ при $k = 0$.
Формально говоря, на прямой $y = 0$, $x \ne \pm 1$ касательная будет вертикальной, а в точках $\br{-1; 0}$ и $\br{1; 0}$ поведение производной неясно.
На левом рисунке изображены изоклины, на правом -- решения уравнений.

\begin{figure}[!h]
\begin{minipage}{.5\textwidth}
    \centering
    \begin{tikzpicture}
        \pgfplotsset{
            Graph/.style = {
                samples = 300,
                restrict y to domain = -5 : 5,
            },
            DirectionGraph/.style = {
                samples = 10,
                quiver = {scale arrows = 0.075},
                restrict y to domain = -5 : 5,
            },
            DirectionGraph1/.style = {
                DirectionGraph,
                quiver = {
                    u = {dot_x(x, y) / sqrt(dot_x(x, y) ^ 2 + dot_y(x, y) ^ 2)},
                    v = {dot_y(x, y) / sqrt(dot_x(x, y) ^ 2 + dot_y(x, y) ^ 2)}
                }
            },
            DirectionGraph2/.style = {
                DirectionGraph,
                quiver = {
                    u = {-dot_x(x, y) / sqrt(dot_x(x, y) ^ 2 + dot_y(x, y) ^ 2)},
                    v = {-dot_y(x, y) / sqrt(dot_x(x, y) ^ 2 + dot_y(x, y) ^ 2)}
                }
            },
        }
        \begin{axis}[
            width = 7.5cm,
            height = 10cm,
            ymin = -4.2,
            ymax = 4.2,
            xmin = -4.2,
            xmax = 4.2, 
            xtick = {-10, ..., 10},
            ytick = {-10, ..., 10},
            minor tick num = 3,
            declare function = {
                f(\k, \x) = sqrt((1 - x * x) / \k);
                g(\k, \x) = sqrt(1 - \k * x * x);
                dot_x(\x, \y) = y * y;
                dot_y(\x, \y) = 1 - x * x;
            }]
            
            \pgfplotsinvokeforeach {0.5, 1, ..., 3, 0.1, 0.15, 0.2, 0.3, 0.05, 0.075, 5, 10, 50} {
                \draw [gray] (axis cs: 0, 0) ellipse
                [x radius = 1, y radius = 1 / sqrt(#1)];
                \addplot[DirectionGraph1, samples = 8, domain = -1 + 0.1 : 1 - 0.1]
                {f(#1, x)};
                \addplot[DirectionGraph2, samples = 8, domain = -1 + 0.1 : 1 - 0.1]
                {f(#1, x)};
                \addplot[DirectionGraph1, samples = 8, domain = -1 + 0.1 : 1 - 0.1]
                {-f(#1, x)};
                \addplot[DirectionGraph2, samples = 8, domain = -1 + 0.1 : 1 - 0.1]
                {-f(#1, x)};
            }

            \foreach \k in {
                0.5, 1, ..., 4, 0, 0.75, 0.1, 0.05, 0.2, 0.3} {
                \foreach \s in {-1, 1} {
                    \addplot[Graph, gray, domain = -5 : 5]
                    ({\s * g(-\k, x)}, {x});
                    \addplot[Graph, gray, domain = -5 : 5]
                    ({\s * g(-\k, x)}, {x});
                    
                    \addplot[DirectionGraph1, domain = -4 : -0.5]
                    ({\s * g(-\k, x)}, {x});
                    \addplot[DirectionGraph2, domain = -4 : -0.5]
                    ({\s * g(-\k, x)}, {x});
                    \addplot[DirectionGraph1, domain = 0.5 : 4]
                    ({\s * g(-\k, x)}, {x});
                    \addplot[DirectionGraph2, domain = 0.5 : 4]
                    ({\s * g(-\k, x)}, {x});
                }
            }
            
            \foreach \k in {6, 10, 22, 50, 70} {
                \foreach \s in {-1, 1} {
                    \addplot[Graph, gray, domain = -5 : 5]
                    ({\s * g(-\k, x)}, {x});
                    \addplot[Graph, gray, domain = -5 : 5]
                    ({\s * g(-\k, x)}, {x});
                    
                    \addplot[DirectionGraph1, samples = 20, domain = -4 : -0.5]
                    ({\s * g(-\k, x)}, {x});
                    \addplot[DirectionGraph2, samples = 20, domain = -4 : -0.5]
                    ({\s * g(-\k, x)}, {x});
                    \addplot[DirectionGraph1, samples = 20, domain = 0.5 : 4]
                    ({\s * g(-\k, x)}, {x});
                    \addplot[DirectionGraph2, samples = 20, domain = 0.5 : 4]
                    ({\s * g(-\k, x)}, {x});
                }
            }            
        \end{axis}
    \end{tikzpicture}
\end{minipage}
\begin{minipage}{.5\textwidth}
    \centering
    \begin{tikzpicture}
        \usetikzlibrary{math}
        \pgfplotsset{
            Graph/.style = {
                opacity = 0.3,
                samples = 300,
                restrict y to domain = -5 : 5,
            },
            PreciseGraph/.style = {
                Graph,
                thick,
                opacity = 1,
                samples = 1000,
            },
            DirectionGraph/.style = {
                opacity = 0.3,
                samples = 10,
                quiver = {scale arrows = 0.075},
                restrict y to domain = -5 : 5,
            },
            DirectionGraph1/.style = {
                DirectionGraph,
                quiver = {
                    u = {dot_x(x, y) / sqrt(dot_x(x, y) ^ 2 + dot_y(x, y) ^ 2)},
                    v = {dot_y(x, y) / sqrt(dot_x(x, y) ^ 2 + dot_y(x, y) ^ 2)}
                }
            },
            DirectionGraph2/.style = {
                DirectionGraph,
                quiver = {
                    u = {-dot_x(x, y) / sqrt(dot_x(x, y) ^ 2 + dot_y(x, y) ^ 2)},
                    v = {-dot_y(x, y) / sqrt(dot_x(x, y) ^ 2 + dot_y(x, y) ^ 2)}
                }
            },
        }
        \begin{axis}[
            width = 7.5cm,
            height = 10cm,
            ymin = -4.2,
            ymax = 4.2,
            xmin = -4.2,
            xmax = 4.2, 
            xtick = {-10, ..., 10},
            ytick = {-10, ..., 10},
            minor tick num = 3,
            declare function = {
                f(\k, \x) = sqrt((1 - x * x) / \k);
                g(\k, \x) = sqrt(1 - \k * x * x);
                dot_x(\x, \y) = y * y;
                dot_y(\x, \y) = 1 - x * x;
            }]
            
            \pgfplotsinvokeforeach {0.5, 1, ..., 3, 0.1, 0.15, 0.2, 0.3, 0.05, 0.075, 5, 10, 50} {
                \draw [gray] (axis cs: 0, 0) ellipse
                [x radius = 1, y radius = 1 / sqrt(#1)];
                \addplot[DirectionGraph1, samples = 8, domain = -1 + 0.1 : 1 - 0.1]
                {f(#1, x)};
                \addplot[DirectionGraph2, samples = 8, domain = -1 + 0.1 : 1 - 0.1]
                {f(#1, x)};
                \addplot[DirectionGraph1, samples = 8, domain = -1 + 0.1 : 1 - 0.1]
                {-f(#1, x)};
                \addplot[DirectionGraph2, samples = 8, domain = -1 + 0.1 : 1 - 0.1]
                {-f(#1, x)};
            }

            \foreach \k in {
                0.5, 1, ..., 4, 0, 0.75, 0.1, 0.05, 0.2, 0.3} {
                \foreach \s in {-1, 1} {
                    \addplot[Graph, gray, domain = -5 : 5]
                    ({\s * g(-\k, x)}, {x});
                    \addplot[Graph, gray, domain = -5 : 5]
                    ({\s * g(-\k, x)}, {x});
                    
                    \addplot[DirectionGraph1, domain = -4 : -0.5]
                    ({\s * g(-\k, x)}, {x});
                    \addplot[DirectionGraph2, domain = -4 : -0.5]
                    ({\s * g(-\k, x)}, {x});
                    \addplot[DirectionGraph1, domain = 0.5 : 4]
                    ({\s * g(-\k, x)}, {x});
                    \addplot[DirectionGraph2, domain = 0.5 : 4]
                    ({\s * g(-\k, x)}, {x});
                }
            }
            
            \foreach \k in {6, 10, 22, 50, 70} {
                \foreach \s in {-1, 1} {
                    \addplot[Graph, gray, domain = -5 : 5]
                    ({\s * g(-\k, x)}, {x});
                    \addplot[Graph, gray, domain = -5 : 5]
                    ({\s * g(-\k, x)}, {x});
                    
                    \addplot[DirectionGraph1, samples = 20, domain = -4 : -0.5]
                    ({\s * g(-\k, x)}, {x});
                    \addplot[DirectionGraph2, samples = 20, domain = -4 : -0.5]
                    ({\s * g(-\k, x)}, {x});
                    \addplot[DirectionGraph1, samples = 20, domain = 0.5 : 4]
                    ({\s * g(-\k, x)}, {x});
                    \addplot[DirectionGraph2, samples = 20, domain = 0.5 : 4]
                    ({\s * g(-\k, x)}, {x});
                }
            }            
                
            \addplot[id = 20.C-20, PreciseGraph, olive, domain = -5 : 5]
            gnuplot {cbrt(-x ** 3 + 3 * x - 20)};
                
            \addplot[id = 20.C-10, PreciseGraph, green, domain = -5 : 5]
            gnuplot {cbrt(-x ** 3 + 3 * x - 10)};
                
            \addplot[id = 20.C-4, PreciseGraph, orange, domain = -5 : 5]
            gnuplot {cbrt(-x ** 3 + 3 * x - 4)};
                
            \addplot[id = 20.C-2, PreciseGraph, darkgray, domain = -5 : 5]
            gnuplot {cbrt(-x ** 3 + 3 * x - 2)};
                
            \addplot[id = 20.C-1, PreciseGraph, red, domain = -5 : 5]
            gnuplot {cbrt(-x ** 3 + 3 * x - 1)};
                
            \addplot[id = 20.C0, PreciseGraph, magenta, domain = -5 : 5]
            gnuplot {cbrt(-x ** 3 + 3 * x)};
                
            \addplot[id = 20.C1, PreciseGraph, blue, domain = -5 : 5]
            gnuplot {cbrt(-x ** 3 + 3 * x + 1)};
                
            \addplot[id = 20.C2, PreciseGraph, purple, domain = -5 : 5]
            gnuplot {cbrt(-x ** 3 + 3 * x + 2)};
                
            \addplot[id = 20.C4, PreciseGraph, orange, domain = -5 : 5]
            gnuplot {cbrt(-x ** 3 + 3 * x + 4)};
                
            \addplot[id = 20.C10, PreciseGraph, olive, domain = -5 : 5]
            gnuplot {cbrt(-x ** 3 + 3 * x + 10)};
                
            \addplot[id = 20.C20, PreciseGraph, violet, domain = -5 : 5]
            gnuplot {cbrt(-x ** 3 + 3 * x + 20)};
        \end{axis}
    \end{tikzpicture}
\end{minipage}
\end{figure}

\begin{remark} Кривые на рисунке справа построены \vspace{1mm} по общему решению исходного уравнения, которое имеет вид $y\br{x} = \sqrt[3] {-x^3 + 3x + C}$.
\end{remark} 

\end{document}
