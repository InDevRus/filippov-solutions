\documentclass[a5paper,10pt]{article}

% https://github.com/InDevRus/filippov-solutions

\input{../preambles/general}
\input{../preambles/plotting}

\begin{document}

$f\br{x; y} = \dfrac {y} {y + x}$. Уравнение изоклины: $\dfrac {y} {y + x} = k$. $y\br{x} = \dfrac {k} {1 - k} x$. Таким образом, изоклинами будут прямые. На левом рисунке изображены изоклины, на правом -- решения уравнений.

\begin{figure}[!h]
\begin{minipage}{.5\textwidth}
    \centering
    \begin{tikzpicture}
        \pgfplotsset{
            Graph/.style = {
                samples = 60,
                restrict y to domain = -5 : 5,
            },
            DirectionGraph/.style = {
                samples = 20,
                quiver = {scale arrows = 0.075},
                restrict y to domain = -5 : 5,
            },
            DirectionGraph1/.style = {
                DirectionGraph,
                quiver = {
                    u = {dot_x(x, y) / sqrt(dot_x(x, y) ^ 2 + dot_y(x, y) ^ 2)},
                    v = {dot_y(x, y) / sqrt(dot_x(x, y) ^ 2 + dot_y(x, y) ^ 2)}
                }
            },
            DirectionGraph2/.style = {
                DirectionGraph,
                quiver = {
                    u = {-dot_x(x, y) / sqrt(dot_x(x, y) ^ 2 + dot_y(x, y) ^ 2)},
                    v = {-dot_y(x, y) / sqrt(dot_x(x, y) ^ 2 + dot_y(x, y) ^ 2)}
                }
            },
        }
        \begin{axis}[
            width = 7.5cm,
            height = 10cm,
            ymin = -4.2,
            ymax = 4.2,
            xmin = -4.2,
            xmax = 4.2, 
            xtick = {-10, ..., 10},
            ytick = {-10, ..., 10},
            minor tick num = 3,
            declare function = {
                f(\k, \x) = x * \k;
                dot_x(\x, \y) = y + x;
                dot_y(\x, \y) = y;
            }]
            
            \foreach \k in {0.1, 0.2, 0.3, 0.5, 0.75, 1, 1.5, 2, 3} {
                \foreach \s in {-1, 1} {
                    \addplot[Graph, gray, domain = -4.5 : 4.5]
                    {f(\s * \k, x)};
                    \addplot[DirectionGraph1, domain = -4 : -0.25]
                    {f(\s * \k, x)};
                    \addplot[DirectionGraph1, domain = 0.25 : 4]
                    {f(\s * \k, x)};
                    \addplot[DirectionGraph2, domain = -4 : -0.25]
                    {f(\s * \k, x)};
                    \addplot[DirectionGraph2, domain = 0.25 : 4]
                    {f(\s * \k, x)};
                }
            }
            
            \foreach \k in {4.5, 15} {
                \foreach \s in {-1, 1} {
                    \addplot[Graph, gray, domain = -1 : 1]
                    {f(\s * \k, x)};
                    \addplot[DirectionGraph1, domain = -1.5 : -0.25]
                    {f(\s * \k, x)};
                    \addplot[DirectionGraph1, domain = 0.25 : 1.5]
                    {f(\s * \k, x)};
                    \addplot[DirectionGraph2, domain = -1.5 : -0.25]
                    {f(\s * \k, x)};
                    \addplot[DirectionGraph2, domain = 0.25 : 1.5]
                    {f(\s * \k, x)};
                }
            }
        \end{axis}
    \end{tikzpicture}
\end{minipage}
\begin{minipage}{.5\textwidth}
    \centering
    \begin{tikzpicture}
        \pgfplotsset{
            Graph/.style = {
                samples = 60,
                restrict y to domain = -5 : 5,
                opacity = 0.5,
            },
            PreciseGraph/.style = {
                Graph,
                thick,
                samples = 400,
                restrict y to domain = -5 : 5,
                opacity = 1,
            },
            DirectionGraph/.style = {
                opacity = 0.5,
                samples = 20,
                quiver = {scale arrows = 0.075},
                restrict y to domain = -5 : 5,
            },
            DirectionGraph1/.style = {
                DirectionGraph,
                quiver = {
                    u = {dot_x(x, y) / sqrt(dot_x(x, y) ^ 2 + dot_y(x, y) ^ 2)},
                    v = {dot_y(x, y) / sqrt(dot_x(x, y) ^ 2 + dot_y(x, y) ^ 2)}
                }
            },
            DirectionGraph2/.style = {
                DirectionGraph,
                quiver = {
                    u = {-dot_x(x, y) / sqrt(dot_x(x, y) ^ 2 + dot_y(x, y) ^ 2)},
                    v = {-dot_y(x, y) / sqrt(dot_x(x, y) ^ 2 + dot_y(x, y) ^ 2)}
                }
            },
        }
        \begin{axis}[
            trig format = rad,
            width = 7.5cm,
            height = 10cm,
            ymin = -4.2,
            ymax = 4.2,
            xmin = -4.2,
            xmax = 4.2, 
            xtick = {-10, ..., 10},
            ytick = {-10, ..., 10},
            minor tick num = 3,
            declare function = {
                f(\k, \x) = x * \k;
                dot_x(\x, \y) = y + x;
                dot_y(\x, \y) = y;
                h(\D, \x) = \D * exp(cot(x)) / sin(x);
            }]
            
            \addplot[PreciseGraph, cyan, domain = -20 : 20]
            ({h(0.5, x) * cos(x)}, {h(0.5, x) * sin(x)});
            \addplot[PreciseGraph, cyan, domain = -20 : 20]
            ({h(-0.5, x) * cos(x)}, {h(-0.5, x) * sin(x)});
            \addplot[PreciseGraph, violet, domain = -20 : 20]
            ({h(1, x) * cos(x)}, {h(1, x) * sin(x)});
            \addplot[PreciseGraph, violet, domain = -20 : 20]
            ({h(-1, x) * cos(x)}, {h(-1, x) * sin(x)});
            \addplot[PreciseGraph, blue, domain = -20 : 20]
            ({h(1.5, x) * cos(x)}, {h(1.5, x) * sin(x)});
            \addplot[PreciseGraph, blue, domain = -20 : 20]
            ({h(-1.5, x) * cos(x)}, {h(-1.5, x) * sin(x)});
            \addplot[PreciseGraph, olive, domain = -20 : 20]
            ({h(2, x) * cos(x)}, {h(2, x) * sin(x)});
            \addplot[PreciseGraph, olive, domain = -20 : 20]
            ({h(-2, x) * cos(x)}, {h(-2, x) * sin(x)});
            \addplot[PreciseGraph, red, domain = -20 : 20]
            ({h(2.5, x) * cos(x)}, {h(2.5, x) * sin(x)});
            \addplot[PreciseGraph, red, domain = -20 : 20]
            ({h(-2.5, x) * cos(x)}, {h(-2.5, x) * sin(x)});
            \addplot[PreciseGraph, gray, domain = -20 : 20]
            ({h(5, x) * cos(x)}, {h(5, x) * sin(x)});
            \addplot[PreciseGraph, gray, domain = -20 : 20]
            ({h(-5, x) * cos(x)}, {h(-5, x) * sin(x)});
            \addplot[PreciseGraph, orange, domain = -20 : 20]
            ({h(9, x) * cos(x)}, {h(9, x) * sin(x)});
            \addplot[PreciseGraph, orange, domain = -20 : 20]
            ({h(-9, x) * cos(x)}, {h(-9, x) * sin(x)});
            
            \foreach \k in {0.1, 0.2, 0.3, 0.5, 0.75, 1, 1.5, 2, 3} {
                \foreach \s in {-1, 1} {
                    \addplot[Graph, gray, domain = -4.5 : 4.5]
                    {f(\s * \k, x)};
                    \addplot[DirectionGraph1, domain = -4 : -0.25]
                    {f(\s * \k, x)};
                    \addplot[DirectionGraph1, domain = 0.25 : 4]
                    {f(\s * \k, x)};
                    \addplot[DirectionGraph2, domain = -4 : -0.25]
                    {f(\s * \k, x)};
                    \addplot[DirectionGraph2, domain = 0.25 : 4]
                    {f(\s * \k, x)};
                }
            }
            
            \foreach \k in {4.5, 15} {
                \foreach \s in {-1, 1} {
                    \addplot[Graph, gray, domain = -1 : 1]
                    {f(\s * \k, x)};
                    \addplot[DirectionGraph1, domain = -1.5 : -0.25]
                    {f(\s * \k, x)};
                    \addplot[DirectionGraph1, domain = 0.25 : 1.5]
                    {f(\s * \k, x)};
                    \addplot[DirectionGraph2, domain = -1.5 : -0.25]
                    {f(\s * \k, x)};
                    \addplot[DirectionGraph2, domain = 0.25 : 1.5]
                    {f(\s * \k, x)};
                }
            }
        \end{axis}
    \end{tikzpicture}
\end{minipage}
\end{figure}

\begin{remark} Кривые на рисунке справа построены \vspace{1mm} по общему решению исходного уравнения, которое можно задать либо в параметрической форме
$$\tsys{& x\br{t} = C f\br{t} \\& y\br{t} = Ct f\br{t}}\text{, где } f\br{t} = \dfrac {\tpow{e}{\elevate{\frac {1} {t}}}} {t},$$
либо в форме в полярных координатах
$\tsys{& x\br{\phi} = C r\br{\phi} \cos\phi \\& y\br{\phi} = C r\br{\phi} \sin\phi}$, где $r\br{\phi} = \dfrac { \tpow{e}{\ctg\phi}} {\sin\phi}$.
\end{remark} 

\end{document}
